--RefDomicilioExterno = endpointcode


select * from [3PL_POOL].dbo.PL_DELIVERYADDRESSES where IDDELIVERYADDRESSES in (
select distinct ID_DELIVERYADDRESS1 from [3PL_POOL].dbo.PL_ORDERS where EXTERNORDERKEY in (
'9740735906',
'9740736035',
'9740736172',
'9740736298',
'9740736506',
'9740736553',
'9740737263',
'9740737691',
'9740737817',
'9740737902',
'9740738239',
'9740738465') 
)


select distinct ENDPOINTCODE, state, NSTATE, * from [3PL_POOL].dbo.PL_DELIVERYADDRESSES where ENDPOINTCODE in (
'9731316',
'9731330',
'9731706',
'9731419',
'9700816',
'9700774') 
and IDCUSTOMER in (67, 2806)


select distinct ENDPOINTCODE, IDCUSTOMER, INFORMEDSTREET, state, NSTATE, DISTRICT, NDISCTRICT, street, NSTREET, zip, nzip, city, NCITY, LATITUDE, LONGITUDE, * 
from [3PL_POOL].dbo.PL_DELIVERYADDRESSES where ENDPOINTCODE in ('9731706') and IDCUSTOMER in (67, 2806) 


select * from [3PL_POOL].dbo.PL_CUSTOMERS where IDCUSTOMER in (
select distinct IDCUSTOMER from [3PL_POOL].dbo.PL_DELIVERYADDRESSES where ENDPOINTCODE in (
'9731316',
'9731330',
'9731706',
'9731419',
'9700816',
'9700774')
)

select * from [3PL_POOL].dbo.PL_CUSTOMERS where IdCustomer = 67